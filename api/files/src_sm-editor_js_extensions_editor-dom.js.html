<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/sm-editor/js/extensions/editor-dom.js - SmugMug YUI Gallery API docs</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="SmugMug YUI Gallery API docs"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 3.11.0-git</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/DragDrop.html">DragDrop</a></li>
            
                <li><a href="../classes/Editor.html">Editor</a></li>
            
                <li><a href="../classes/Editor.Base.html">Editor.Base</a></li>
            
                <li><a href="../classes/Editor.DOM.html">Editor.DOM</a></li>
            
                <li><a href="../classes/Editor.Keys.html">Editor.Keys</a></li>
            
                <li><a href="../classes/Editor.Link.html">Editor.Link</a></li>
            
                <li><a href="../classes/Editor.Queue.html">Editor.Queue</a></li>
            
                <li><a href="../classes/Editor.Style.html">Editor.Style</a></li>
            
                <li><a href="../classes/Editor.Undo.html">Editor.Undo</a></li>
            
                <li><a href="../classes/IndexedMap.html">IndexedMap</a></li>
            
                <li><a href="../classes/Map.html">Map</a></li>
            
                <li><a href="../classes/Menu.html">Menu</a></li>
            
                <li><a href="../classes/Menu.Base.html">Menu.Base</a></li>
            
                <li><a href="../classes/Menu.Item.html">Menu.Item</a></li>
            
                <li><a href="../classes/Menu.Templates.html">Menu.Templates</a></li>
            
                <li><a href="../classes/Plugin.DragDrop.Reorder.html">Plugin.DragDrop.Reorder</a></li>
            
                <li><a href="../classes/Plugin.FocusManager.html">Plugin.FocusManager</a></li>
            
                <li><a href="../classes/Plugin.Menu.html">Plugin.Menu</a></li>
            
                <li><a href="../classes/Promise.EventNotifier.html">Promise.EventNotifier</a></li>
            
                <li><a href="../classes/Range.html">Range</a></li>
            
                <li><a href="../classes/Selection.html">Selection</a></li>
            
                <li><a href="../classes/TreeView.html">TreeView</a></li>
            
                <li><a href="../classes/TreeView.Sortable.html">TreeView.Sortable</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/dom-form-values.html">dom-form-values</a></li>
            
                <li><a href="../modules/gallery-sm-dragdrop.html">gallery-sm-dragdrop</a></li>
            
                <li><a href="../modules/gallery-sm-dragdrop-reorder.html">gallery-sm-dragdrop-reorder</a></li>
            
                <li><a href="../modules/gallery-sm-editor.html">gallery-sm-editor</a></li>
            
                <li><a href="../modules/gallery-sm-editor-base.html">gallery-sm-editor-base</a></li>
            
                <li><a href="../modules/gallery-sm-editor-dom.html">gallery-sm-editor-dom</a></li>
            
                <li><a href="../modules/gallery-sm-editor-keys.html">gallery-sm-editor-keys</a></li>
            
                <li><a href="../modules/gallery-sm-editor-link.html">gallery-sm-editor-link</a></li>
            
                <li><a href="../modules/gallery-sm-editor-queue.html">gallery-sm-editor-queue</a></li>
            
                <li><a href="../modules/gallery-sm-editor-style.html">gallery-sm-editor-style</a></li>
            
                <li><a href="../modules/gallery-sm-editor-undo.html">gallery-sm-editor-undo</a></li>
            
                <li><a href="../modules/gallery-sm-focusmanager.html">gallery-sm-focusmanager</a></li>
            
                <li><a href="../modules/gallery-sm-indexed-map.html">gallery-sm-indexed-map</a></li>
            
                <li><a href="../modules/gallery-sm-map.html">gallery-sm-map</a></li>
            
                <li><a href="../modules/gallery-sm-menu.html">gallery-sm-menu</a></li>
            
                <li><a href="../modules/gallery-sm-menu-base.html">gallery-sm-menu-base</a></li>
            
                <li><a href="../modules/gallery-sm-menu-item.html">gallery-sm-menu-item</a></li>
            
                <li><a href="../modules/gallery-sm-menu-plugin.html">gallery-sm-menu-plugin</a></li>
            
                <li><a href="../modules/gallery-sm-menu-templates.html">gallery-sm-menu-templates</a></li>
            
                <li><a href="../modules/gallery-sm-promise-events.html">gallery-sm-promise-events</a></li>
            
                <li><a href="../modules/gallery-sm-range.html">gallery-sm-range</a></li>
            
                <li><a href="../modules/gallery-sm-selection.html">gallery-sm-selection</a></li>
            
                <li><a href="../modules/gallery-sm-treeview.html">gallery-sm-treeview</a></li>
            
                <li><a href="../modules/gallery-sm-treeview-sortable.html">gallery-sm-treeview-sortable</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src/sm-editor/js/extensions/editor-dom.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*jshint expr:true, onevar:false */

/**
Provides the &#x60;Editor.DOM&#x60; utility class.

@module gallery-sm-editor
@submodule gallery-sm-editor-dom
**/

/**
DOM utility methods for &#x60;Editor.Base&#x60;

@class Editor.DOM
**/

var EditorDOM = {};

EditorDOM.inlineElements = &#x27;b, em, i, span, strong, u&#x27;;

/**
Copies styles from a node to another node
@param {HTMLElement|Node} from
@param {HTMLElement|Node} to
@param {Array} styles
@param {Object} [options]
    @param {Boolean} [options.explicit=false] When set to &#x60;true&#x60; copy only
        explicitly set properties from the source node. IOW, don&#x27;t use
        computedStyle.
    @param {Boolean} [options.overwrite=false] When set to &#x60;true&#x60;
        properties from the source node will overwrite the same property
        set on the destination node.
**/
EditorDOM.copyStyles = function(from, to, styles, options) {
    var newStyles = {},
        explicit = options &amp;&amp; options.explicit,
        overwrite = options &amp;&amp; options.overwrite;

    from = Y.one(from);
    to = Y.one(to);

    if (!EditorDOM.isElementNode(from) || !EditorDOM.isElementNode(to)) {
        return;
    }

    Y.Array.each(styles, function(prop) {
        var newVal = explicit ? from._node.style[prop] : from.getStyle(prop);

        if (&#x27;&#x27; !== newVal &amp;&amp; (overwrite || &#x27;&#x27; === to._node.style[prop])) {
            newStyles[prop] = newVal;
        }
    });

    to.setStyles(newStyles);
};


/**
Finds the nearest ancestor element node.

@param {Node} node
@param {Function|String} [tagName] Optional tagName or function. If a tagName
  is provided, the nearest ancestor with that tag will be returned. If a
  function is provided, it will be used for the comparision. It will receive
  a node as its only argument and should return a boolean. If nothing is
  provided, the nearest ancestor element node will be returned
@return {Node}
@static
**/
EditorDOM.getAncestorElement = function(node, tagName) {
    var fn;

    function tagFn(node) {
        var nodeTag = node.get(&#x27;tagName&#x27;);
        return nodeTag &amp;&amp; tagName === nodeTag.toUpperCase();
    }

    if (&#x27;function&#x27; === typeof tagName) {
        fn = tagName;
    } else if (&#x27;string&#x27; === typeof tagName) {
        tagName = tagName.toUpperCase();
        fn = tagFn;
    }

    return node.ancestor(fn || EditorDOM.isElementNode, true);
};


/**
Walks the ancestor tree of a given node until a node that has
the css property set is found

@method getStyledAncestor
@param {Node} startNode
@param {String} property
@param {Boolean} [self] Whether or not to include &#x60;startNode&#x60; in the scan
@return {Node} The node having &#x60;property&#x60; set, or null if no node was found
@static
**/
EditorDOM.getStyledAncestor = function(startNode, property, self) {
    return startNode.ancestor(function(node) {
        if (!EDOM.isElementNode(node)) {
            return false;
        }

        // don&#x27;t use node.getStyle() because it will return
        // computedStyle for empty string values like &#x60;property: &quot;&quot;&#x60;
        // https://github.com/yui/yui3/blob/master/src/dom/js/dom-style.js#L106
        return !!node._node.style[property];
    }, self, this.selectors.input);
};


/**
Returns true if the given node is a container element, false otherwise
A container element is defined as a non-inline element

@method isContainer
@param {HTMLNode|Node} node
@return {Boolean} true if the given node is a container element, false otherwise
@static
**/
EditorDOM.isContainer = function(node) {
    node = Y.one(node);

    // isElementNode() will exclude document fragments, which are valid
    // containers, use !isTextNode() instead
    return !EditorDOM.isTextNode(node) &amp;&amp; !EditorDOM.isInlineElement(node);
};


/**
Returns true if the given node is an element node, false otherwise

@method isElementNode
@param {HTMLNode|Node} node
@return {Boolean} true if the given node is an element node, false otherwise
@static
**/
EditorDOM.isElementNode = function(node) {
    node = Y.one(node);

    return node._node &amp;&amp; 1 === node._node.nodeType;
};


/**
Returns true if the given node is empty

Nodes containing only returns, tabs or linefeeds are considered empty
Nodes containing only whitespace are not considered empty

@method isEmptyNode
@param {HTMLNode|Node} node
@return {Boolean} true if the given node is a empty, false otherwise
@static
**/
EditorDOM.isEmptyNode = function(node) {
    node = Y.one(node);

    var text = node ? node.get(&#x27;text&#x27;) : &#x27;&#x27;;

    return (/^[^\S ]*$/).test(text);
};


/**
Returns true if the given node is an inline element node, false otherwise

@method isInlineElement
@param {HTMLNode|Node} node
@return {Boolean} true if the given node is an inline element node, false otherwise
@static
**/
EditorDOM.isInlineElement = function(node) {
    node = Y.one(node);

    return node &amp;&amp; node.test(EditorDOM.inlineElements);
};


/**
Returns true if the given node is a text node, false otherwise

@method isTextNode
@param {HTMLNode|Node} node
@return {Boolean} true if the given node is a text node, false otherwise
@static
**/
EditorDOM.isTextNode = function(node) {
    node = Y.one(node);

    return node._node &amp;&amp; 3 === node._node.nodeType;
};


/**
Returns the maximum offset of a given node as determined by the type of node.

Element nodes will return the number of childNodes
Text nodes will return the length of the text

@method maxOffset
@param {HTMLNode|Node} node
@return {Number} Number of child nodes or length of text
@static
**/
EditorDOM.maxOffset = function(node) {
    node = Y.one(node);

    return node.get(&#x27;childNodes&#x27;).size() || node.get(&#x27;length&#x27;);
};


/**
Replace spaces in text with a replacement string.

Primarily to workaround a webkit issue where it won&#x27;t put the caret after
trailing whitespace at the end of a node

@param {String} text The source text that will have spaces replaced
@param {String} [replacement=\u00a0] The string to use as the replacement for
    spaces in _text_. Defaults to a nonblank space
@returns {String} _text_ with spaces replaced
**/
EditorDOM.replaceSpaces = function(text, replacement) {
    replacement || (replacement = &#x27;\u00a0&#x27;);

    return text.replace(/ /g, replacement);
};


/**
Splits the given node at the specified offset

@method split
@param {Node} node The node to split
@param {Number|Node} offset Position to split the node.
    For text nodes this is numerical offset, for element nodes can be a
    a number referencing a childNode of &#x60;node&#x60; or a childNode reference.
@returns {Node} Node reference to the node created after splitting. It will
    be the nextSibling of &#x60;node&#x60;. If offset is not valid, the original &#x60;node&#x60;
    is returned.
**/
EditorDOM.split = function(node, offset) {
    var childNodes = node.get(&#x27;childNodes&#x27;),
        splitNode;

    node = Y.one(node);

    if (offset &amp;&amp; offset._node) {
        offset = childNodes.indexOf(offset);
    } else {
        offset = parseInt(offset, 10);
    }

    if (isNaN(offset) || offset &lt; 0 || offset &gt; EditorDOM.maxOffset(node)) {
        return node;
    }

    if (EditorDOM.isTextNode(node)) {
        return Y.one(node._node.splitText(offset));
    } else {
        splitNode = node.cloneNode(false).append(childNodes.splice(offset));
        node.insert(splitNode, &#x27;after&#x27;);

        return splitNode;
    }
};


/**
Unwraps a node

@method unwrap
@param {Node} node
@return {Range} Range containing the unwrapped child nodes
@static
**/
EditorDOM.unwrap = function (node) {
    var range, startNode, endNode;

    startNode = node.get(&#x27;firstChild&#x27;) || node;
    endNode = node.get(&#x27;lastChild&#x27;) || node;

    startNode.unwrap();

    range = new Y.Range();
    range.startNode(startNode);
    range.endNode(endNode, EditorDOM.maxOffset(endNode));

    return range;
};


Y.namespace(&#x27;Editor&#x27;).DOM = EditorDOM;

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
