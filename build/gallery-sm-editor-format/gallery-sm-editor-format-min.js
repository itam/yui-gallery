YUI.add("gallery-sm-editor-format",function(e,t){(function(){var t=e.config.doc,n=e.Editor.DOM,r="<span></span>",i=e.Base.create("editorFormat",e.Base,[],{initializer:function(){this.supportedStyles=[],e.Object.each(this.styleCommands,function(e){this.supportedStyles.push(e.style.property)},this)},_formatHTML:function(i){function s(t){var i=t.get("childNodes")._nodes;e.Array.each(i.reverse(),function(t){var i;t=e.one(t),i=t.get("parentNode"),n.isTextNode(t)?this._isBlockNode(i)?t.wrap(r):t.get("previousSibling")&&n.split(i,t):(t.test(this.supportedTags)?!this._isBlockNode(i)&&!i.test("a")&&(i.insert(t,"after"),this._isBlockNode(t)||(t.addClass(i.get("className")),n.copyStyles(i,t,this.supportedStyles,{explicit:!0,overwrite:!1}))):t.replace(t.get("text")),s.call(this,t),n.isEmptyNode(t)&&t.remove(!0),t.removeAttribute("id"))},this)}var o=e.one(t.createDocumentFragment()).setHTML(i);return s.call(this,o),o},_getHTML:function(t){return t=e.Editor.Base.prototype._getHTML.call(this,t),this.get("formatFn")(t).getHTML()},_isBlockNode:function(t){return t=e.one(t),!n.isTextNode(t)&&(t.get("nodeName")==="#document-fragment"||t.test(this.blockTags))},_isStyleNode:function(t){return t=e.one(t),t&&!n.isTextNode(t)&&t.test(this.styleTags)},_setHTML:function(t){return t=this.get("formatFn")(t).getHTML(),e.Editor.Base.prototype._setHTML.call(this,t)}},{ATTRS:{formatFn:{readOnly:!0,setter:function(t){return e.bind(t,this)},validator:e.Lang.isFunction,valueFn:function(){return this._formatHTML}}}});e.namespace("Editor").Format=i})()},"@VERSION@",{requires:["base-build","gallery-sm-editor-base","gallery-sm-editor-dom","node-base"]});
