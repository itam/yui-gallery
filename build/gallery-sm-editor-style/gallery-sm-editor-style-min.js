YUI.add("gallery-sm-editor-style",function(e,t){(function(){var t=e.Editor.DOM,n="<span></span>",r=e.Base.create("editorStyle",e.Base,[],{styleCommands:{bold:{commandFn:"_execStyleCommand",queryFn:"_queryStyleCommand",style:{property:"fontWeight",value:"bold"}},fontName:{commandFn:"_execStyleCommand",queryFn:"_queryStyleCommand",style:{property:"fontFamily"}},fontSize:{commandFn:"_execStyleCommand",queryFn:"_queryStyleCommand",style:{property:"fontSize"}},italic:{commandFn:"_execStyleCommand",queryFn:"_queryStyleCommand",style:{property:"fontStyle",value:"italic"}},justifyCenter:{commandFn:"_execStyleCommand",queryFn:"_queryStyleCommand",style:{property:"textAlign",value:"center"},type:"block"},justifyFull:{commandFn:"_execStyleCommand",queryFn:"_queryStyleCommand",style:{property:"textAlign",value:"justify"},type:"block"},justifyLeft:{commandFn:"_execStyleCommand",queryFn:"_queryStyleCommand",style:{property:"textAlign",value:""},type:"block"},justifyRight:{commandFn:"_execStyleCommand",queryFn:"_queryStyleCommand",style:{property:"textAlign",value:"right"},type:"block"},strikeThrough:{commandFn:"_execStyleCommand",queryFn:"_queryStyleCommand",style:{property:"textDecoration",value:"line-through"}},underline:{commandFn:"_execStyleCommand",queryFn:"_queryStyleCommand",style:{property:"textDecoration",value:"underline"}}},styleKeyCommands:{"ctrl+b":"bold","ctrl+i":"italic","ctrl+u":"underline"},styleTags:"span",initializer:function(){this.commands=e.merge(this.commands,this.styleCommands),this.supportedTags?this.supportedTags+=","+this.styleTags:this.supportedTags=this.styleTags,this.keyCommands&&(this.keyCommands=e.merge(this.keyCommands,this.styleKeyCommands))},styles:function(e){var t={},n;if(e)for(n in e)e.hasOwnProperty(n)&&(t[n]=this.command(n,e[n]));else{var r=this.styleCommands;for(n in r)r.hasOwnProperty(n)&&(t[n]=this.query(n))}return t},_execStyleCommand:function(t,n){var r=this.commands[t],i=this.selection.range(),s,o;if(!i||!r||!r.style)return;"block"===r.type?s=this._getNodes(i,this.blockTags):s=this._getStyleNodes(i),o=s.item(0)._node.style[r.style.property],e.Lang.isValue(r.style.value)?o&&o===r.style.value?o="":o=r.style.value:n?o=r.style.value||n:o="",s.setStyle(r.style.property,o),"block"!==r.type&&(i.startNode(s.item(0)),i.endNode(s.item(s.size()-1),"after"),this.selection.select(i.shrink()))},_getStyleNodes:function(r){var i,s=[];r.shrink(),i=r.parentNode().ancestor(this.styleTags,!0,this.selectors.input);if(i){if(r.toString()===i.get("text"))return new e.NodeList([i])}else i=e.Node.create(n);var o=r.startNode(),u=r.startOffset(),a=r.endNode(),f=r.endOffset();return r.traverse(function(e){if(!t.isTextNode(e))return;a===e&&f!==t.maxOffset(a)&&(e=t.split(e,f).get("previousSibling")),o===e&&u&&(e=t.split(e,u)),this._isStyleNode(e.get("parentNode"))?(e.get("nextSibling")&&t.split(e.get("parentNode"),e.get("nextSibling")),e.get("previousSibling")&&t.split(e.get("parentNode"),e),s.push(e.get("parentNode"))):s.push(e.wrap(i).get("parentNode"))},this),new e.NodeList(s)},_queryStyleCommand:function(t){var n=this.commands[t],r=this.selection.range().clone(),i="span",s=[],o;return r&&n.style&&("block"===n.type&&(i=this.blockTags),this._getNodes(r,i).each(function(e){var t;n.style.computed?t=e.getStyle(n.style.property):t=e._node.style[n.style.property],s.push(t||"")}),s=e.Array.dedupe(s),1===s.length&&(o=s[0]),e.Lang.isValue(n.style.value)?o=o==n.style.value:""===o&&(o=null)),o}});e.namespace("Editor").Style=r})()},"@VERSION@",{requires:["base-build","gallery-sm-editor-base","gallery-sm-editor-dom","gallery-sm-editor-keys","node-base","node-style"]});
